function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}require("firebase/auth");var r=e(require("prop-types")),n=require("@use-firebase/app"),t=require("react"),i=e(t),u=function(e){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e.reduce(function(e,n,t){return e+" "+("function"==typeof r[t]?r[t]():r[t]||"")+" "+n},"").split(/[\s,]/).map(function(e){return e.trim()}).filter(function(e){return!!e})},o=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var n=Array.isArray(e[0])?u.apply(void 0,e):u([e.join(" ")]);return Object.freeze(n.reduce(function(e,r){var n;return Object.assign({},e,((n={})[r]=r,n))},{}))}("ANONYMOUS","GITHUB","GOOGLE","FACEBOOK","TWITTER","UNKNOWN"),a={anonymous:o.ANONYMOUS,"github.com":o.GITHUB,"google.com":o.GOOGLE,"facebook.com":o.FACEBOOK,"twitter.com":o.TWITTER},s="displayName,email,emailVerified,isAnonymous,phoneNumber,photoURL,uid".split(","),c={};c[o.GITHUB]="GithubAuthProvider",c[o.GOOGLE]="GoogleAuthProvider",c[o.FACEBOOK]="FacebookAuthProvider",c[o.TWITTER]="TwitterAuthProvider";var f=["signInWithRedirect","signInWithPopup"],d={loading:!0},l=function(e){var r=t.useState(d),n=r[0],i=r[1],u=t.useState(null),l=u[0],p=u[1],v=t.useCallback(function(e){p(e)},[p]),h=t.useMemo(function(){return e.auth()},[e]),m=t.useCallback(function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return p(null),function(e,r,n){void 0===n&&(n={});var t=n.method;if(void 0===t&&(t="signInWithRedirect"),f.includes(t))return r.isOAuthProvider?e[t](r):e.signInAnonymously();throw new Error("Invalid signIn method.")}.apply(void 0,[h].concat(e)).catch(v)},[h,p,v]),g=t.useCallback(function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return function(e){return e.signOut()}.apply(void 0,[h].concat(e))},[h]),b=t.useCallback(function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return function(e,r){var n=c[r];return n?new e.firebase_.auth[n]:{}}.apply(void 0,[e].concat(r))},[e]);return t.useEffect(function(){return h.onAuthStateChanged(function(e){var r=!!e,n=r?function(e){var r=s.reduce(function(r,n){var t;return Object.assign({},r,((t={})[n]=null===e[n]?void 0:e[n],t))},{});r.authProvider=a[r.isAnonymous?"anonymous":e.providerData[0].providerId]||o.UNKNOWN;var n=e.metadata,t=n.lastSignInTime;return r.creationTime=new Date(n.creationTime),r.lastSignInTime=new Date(t),r.displayName||(r.displayName="USER_"+r.uid.substr(0,6)),r}(e):{};i({isSignedIn:r,user:n,_user:e})})},[h,i]),t.useEffect(function(){h.getRedirectResult().catch(v)},[h,v]),t.useMemo(function(){return Object.assign({},n,{signInError:l,app:e,signIn:m,signOut:g,createAuthProvider:b})},[n,l,e,m,g,b])},p=i.createContext(),v=Symbol(),h=function(e){var r=e.children,n=(0,e.useFirebaseApp)(),u=l(n),o=t.useMemo(function(){return{signature:v,session:u}},[u]);return i.createElement(p.Provider,{value:o},r)};h.propTypes={children:r.element.isRequired,useFirebaseApp:r.func},h.defaultProps={useFirebaseApp:n.useFirebaseApp};exports.AuthProvider=o,exports.FirebaseAuthProvider=h,exports.useFirebaseAuth=function(){var e=t.useContext(p)||{},r=e.session;if(e.signature!==v)throw new Error("useFirebaseAuth must be a descendant of <FirebaseAuthProvider/>");return r};
