!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("firebase/auth"),require("prop-types"),require("@use-firebase/app"),require("react")):"function"==typeof define&&define.amd?define(["exports","firebase/auth","prop-types","@use-firebase/app","react"],r):r(e.auth={},null,e.PropTypes,e.app,e.react)}(this,function(e,r,n,t,i){n=n&&n.hasOwnProperty("default")?n.default:n;var u="default"in i?i.default:i,o=function(e){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e.reduce(function(e,n,t){return e+" "+("function"==typeof r[t]?r[t]():r[t]||"")+" "+n},"").split(/[\s,]/).map(function(e){return e.trim()}).filter(function(e){return!!e})},a=function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var n=Array.isArray(e[0])?o.apply(void 0,e):o([e.join(" ")]);return Object.freeze(n.reduce(function(e,r){var n;return Object.assign({},e,((n={})[r]=r,n))},{}))}("ANONYMOUS","GITHUB","GOOGLE","FACEBOOK","TWITTER","UNKNOWN"),s={anonymous:a.ANONYMOUS,"github.com":a.GITHUB,"google.com":a.GOOGLE,"facebook.com":a.FACEBOOK,"twitter.com":a.TWITTER},c="displayName,email,emailVerified,isAnonymous,phoneNumber,photoURL,uid".split(","),f={};f[a.GITHUB]="GithubAuthProvider",f[a.GOOGLE]="GoogleAuthProvider",f[a.FACEBOOK]="FacebookAuthProvider",f[a.TWITTER]="TwitterAuthProvider";var d=["signInWithRedirect","signInWithPopup"],p={loading:!0},l=function(e){var r=i.useState(p),n=r[0],t=r[1],u=i.useState(null),o=u[0],l=u[1],h=i.useCallback(function(e){l(e)},[l]),v=i.useMemo(function(){return e.auth()},[e]),m=i.useCallback(function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return l(null),function(e,r,n){void 0===n&&(n={});var t=n.method;if(void 0===t&&(t="signInWithRedirect"),d.includes(t))return r.isOAuthProvider?e[t](r):e.signInAnonymously();throw new Error("Invalid signIn method.")}.apply(void 0,[v].concat(e)).catch(h)},[v,l,h]),b=i.useCallback(function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return function(e){return e.signOut()}.apply(void 0,[v].concat(e))},[v]),g=i.useCallback(function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return function(e,r){var n=f[r];return n?new e.firebase_.auth[n]:{}}.apply(void 0,[e].concat(r))},[e]);return i.useEffect(function(){return v.onAuthStateChanged(function(e){var r=!!e,n=r?function(e){var r=c.reduce(function(r,n){var t;return Object.assign({},r,((t={})[n]=null===e[n]?void 0:e[n],t))},{});r.authProvider=s[r.isAnonymous?"anonymous":e.providerData[0].providerId]||a.UNKNOWN;var n=e.metadata,t=n.lastSignInTime;return r.creationTime=new Date(n.creationTime),r.lastSignInTime=new Date(t),r.displayName||(r.displayName="USER_"+r.uid.substr(0,6)),r}(e):{};t({isSignedIn:r,user:n,_user:e})})},[v,t]),i.useEffect(function(){v.getRedirectResult().catch(h)},[v,h]),i.useMemo(function(){return Object.assign({},n,{signInError:o,app:e,signIn:m,signOut:b,createAuthProvider:g})},[n,o,e,m,b,g])},h=u.createContext(),v=Symbol(),m=function(e){var r=e.children,n=(0,e.useFirebaseApp)(),t=l(n),o=i.useMemo(function(){return{signature:v,session:t}},[t]);return u.createElement(h.Provider,{value:o},r)};m.propTypes={children:n.element.isRequired,useFirebaseApp:n.func},m.defaultProps={useFirebaseApp:t.useFirebaseApp};e.AuthProvider=a,e.FirebaseAuthProvider=m,e.useFirebaseAuth=function(){var e=i.useContext(h)||{},r=e.session;if(e.signature!==v)throw new Error("useFirebaseAuth must be a descendant of <FirebaseAuthProvider/>");return r}});
